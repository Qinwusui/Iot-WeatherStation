# 贰零贰贰·腊月廿七

## 记一次添加图标至单片机屏幕的过程

- 今天突然想起一个需求：给WiFi显示网络强度。很明确的目标，那么现在就从绘制WiFi强度图标开始

我打算照着Windows上的WiFi图标绘制，总觉得这样的图标耐看

  1. 启动PCToLCD，开始绘制点阵图，点阵图的长和宽都是16像素
  2. WiFi强度可以划分为：差，较差，较好，极好 四个阶段，故需要画四张不同强度的点阵
  3. WiFi强度一般是范围是 -30~-120，但普遍范围是-40~-80，两个端点的WiFi强度取端点，这样刚好可以等分四个点阵
  4. 绘制好点阵之后，需要导出为16进制代码，并保存到代码中
  5. 我需要让这个WiFi图标每一秒刷新一次，那么就需要使用定时任务，而该任务又需要在WiFi已连接的情况下调用，那我就可以定义一个定时任务
  6. 任务定义：
    - 必须在WiFi已连接时，当WiFi连接成功后主动调用该任务
    - 当WiFi断开时，将WiFi图标擦去，即不显示（后期将添加WiFi未连接图标）
    - 任务每一秒执行一次，无限循环执行
  7. 任务定义完成之后，需要定义一个WiFi强度转Icon的函数，相当于建立一个`范围与图标的Map`
  8. 当用户通过WiFi控制单片机重连WiFi时，展示WiFi连接动画，该动画为WiFi强度由小到大的动画
    - 实现动画同样使用定时任务，每隔一秒更改一次图标，因为是四个图标，所以只需要`任务执行次数%4==i`即可